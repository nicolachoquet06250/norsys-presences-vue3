(function(e){function t(t){for(var a,r,l=t[0],s=t[1],u=t[2],i=0,d=[];i<l.length;i++)r=l[i],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);b&&b(t);while(d.length)d.shift()();return c.push.apply(c,u||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(a=!1)}a&&(c.splice(t--,1),e=s(s.s=n[0]))}return e}var a={},r={app:0},o={app:0},c=[];function l(e){return s.p+"js/"+({}[e]||e)+"."+{"chunk-2b7c4a34":"d73c122b","chunk-2d0c4fa8":"535c0b82","chunk-2d0d6d35":"e567235d","chunk-2d2086b7":"4445a071","chunk-4b0db170":"7cde7716","chunk-52d5452e":"f70350f0"}[e]+".js"}function s(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,s),n.l=!0,n.exports}s.e=function(e){var t=[],n={"chunk-2b7c4a34":1,"chunk-4b0db170":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-2b7c4a34":"2214c610","chunk-2d0c4fa8":"31d6cfe0","chunk-2d0d6d35":"31d6cfe0","chunk-2d2086b7":"31d6cfe0","chunk-4b0db170":"1a3a86ec","chunk-52d5452e":"31d6cfe0"}[e]+".css",o=s.p+a,c=document.getElementsByTagName("link"),l=0;l<c.length;l++){var u=c[l],i=u.getAttribute("data-href")||u.getAttribute("href");if("stylesheet"===u.rel&&(i===a||i===o))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){u=d[l],i=u.getAttribute("data-href");if(i===a||i===o)return t()}var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.onload=t,b.onerror=function(t){var a=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=a,delete r[e],b.parentNode.removeChild(b),n(c)},b.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(b)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var c=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=c);var u,i=document.createElement("script");i.charset="utf-8",i.timeout=120,s.nc&&i.setAttribute("nonce",s.nc),i.src=l(e);var d=new Error;u=function(t){i.onerror=i.onload=null,clearTimeout(b);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,n[1](d)}o[e]=void 0}};var b=setTimeout((function(){u({type:"timeout",target:i})}),12e4);i.onerror=i.onload=u,document.head.appendChild(i)}return Promise.all(t)},s.m=e,s.c=a,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(s.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)s.d(n,a,function(t){return e[t]}.bind(null,a));return n},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/",s.oe=function(e){throw console.error(e),e};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],i=u.push.bind(u);u.push=t,u=u.slice();for(var d=0;d<u.length;d++)t(u[d]);var b=i;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"16df":function(e,t,n){"use strict";n("84bd")},4360:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return h})),n.d(t,"e",(function(){return y})),n.d(t,"g",(function(){return x})),n.d(t,"f",(function(){return M})),n.d(t,"c",(function(){return S}));var a=n("b85c"),r=n("2909"),o=(n("d81d"),n("d3b7"),n("ddb0"),n("99af"),n("13d5"),n("b64b"),n("7a23")),c=Object(o["x"])(new Date),l=Object(o["x"])({}),s=Object(o["x"])({year:(new Date).getFullYear(),month:(new Date).getMonth(),full_current_date:new Date}),u=Object(o["x"])({previous:null,current:null}),i=Object(o["x"])({});function d(){var e=function(e,t){return Object(r["a"])(Array(t-e).keys()).map((function(t){return t+e}))};function t(){var e;e=c.value.getMonth()+1===12?new Date(c.value.getFullYear()+1,0):new Date(c.value.getFullYear(),c.value.getMonth()+1),b(e.getFullYear(),e.getMonth()+1),c.value=e}function n(){var e;e=c.value.getMonth()+1===1?new Date(c.value.getFullYear()-1,11):new Date(c.value.getFullYear(),c.value.getMonth()-1),b(e.getFullYear(),e.getMonth()+1),c.value=e}function d(e){l.value=e}function b(e,t){s.value={full_current_date:s.value.full_current_date,year:e,month:t}}function p(e,t){u.value={previous:e,current:t}}function g(e){return e=new Date(e),e="".concat(e.getFullYear(),"-").concat(e.getMonth()+1<10?"0":"").concat(e.getMonth()+1,"-").concat(e.getDate()<10?"0":"").concat(e.getDate()),Object.keys(i.value).reduce((function(t,n){return n===e&&(t=n),t}),!1)}function f(e){return g(e)?i.value[e]:""}function v(){fetch("https://calendrier.api.gouv.fr/jours-feries/metropole/".concat(s.value.year,".json")).then((function(e){return e.json()})).then((function(e){i.value=e}))}return null!==s.value.year&&v(),{current_date:Object(o["b"])((function(){return c.value})),calendar:Object(o["b"])((function(){var t,n=l.value,o=u.value.previous,c=1===s.value.month?Object.keys(n):Object.keys(n).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t})),i=0,d=Object(a["a"])(c);try{for(d.s();!(t=d.n()).done;){var b=t.value,p="number"===typeof b?"".concat(b<10?"0":"").concat(b):b;n[p]=n[p].reduce((function(e,t){return t.day<6&&e.push(t),e}),[]);var g=n[p];if(0===i&&g.length<5){for(var f=0,v=g[0]?g[0].day:1,j=0;j<v-1;j++)f++;o-=f;var O=[];for(var h in e(1,f+1)){var m=new Date;m.setYear(12===parseInt(s.value.month)?parseInt(s.value.year)+1:s.value.year),m.setMonth(12===parseInt(s.value.month)?1:s.value.month+1),m.setDate(o),O.push({date:"".concat(m.getFullYear(),"-").concat(m.getMonth()<10?"0":"").concat(m.getMonth(),"-").concat(m.getDate()<10?"0":"").concat(m.getDate()),day:h,presences:[],reservations:[],external_day:!0}),o++}n[p]=[].concat(O,Object(r["a"])(g))}if(i===c.length-1&&g.length<5)for(var _=5-g.length,y=g[g.length-1].day,w=1;w<=_;w++)n[p].push({date:"--".concat(w),day:y,presences:[],reservations:[],external_day:!0}),y++;i++}}catch(k){d.e(k)}finally{d.f()}return n})),calendar_date:Object(o["b"])((function(){return s.value})),nb_days:Object(o["b"])((function(){return u.value})),bank_holidays:Object(o["b"])((function(){return i.value})),nextDate:t,previousDate:n,setCalendar:d,setCalendarDate:b,setNbDays:p,registerBankHoliday:v,isBankHoliday:g,getBankHolidayLabel:f}}var b=d,p=new Date,g=Object(o["x"])(p.getFullYear()+"-"+(p.getMonth()+1<10?"0":"")+(p.getMonth()+1)+"-"+(p.getDate()<10?"0":"")+p.getDate());function f(){return{choosen_date:Object(o["b"])((function(){return g.value})),updateChoosenDate:function(e){g.value=e}}}var v=f,j=Object(o["x"])(!1),O=function(){return{loader_visible:Object(o["b"])((function(){return j.value})),show_loader:function(){j.value=!0},hide_loader:function(){j.value=!1},toggle_loader:function(){j.value=!0!==j.value}}},h=O,m=Object(o["x"])(null!==localStorage.getItem("user")),_=function(){return{logged:Object(o["b"])((function(){return m.value})),setLogged:function(e){m.value=e}}},y=_,w=Object(o["x"])(!1),k=function(){var e=function(){w.value=!w.value},t=function(){w.value=!1};return{opened:Object(o["b"])((function(){return w.value})),toggle:e,reset:t}},x=k,D=Object(o["x"])([]);function C(){return{presences:Object(o["b"])((function(){return D.value})),updatePresences:function(e){D.value=e}}}var M=C,S=function(){var e="https://norsys-sophia-presence.api.nicolaschoquet.fr";return{url_base:e,api_base:"".concat(e,"/api"),days:["","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],months:["","Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],user:Object(o["b"])((function(){return null!==localStorage.getItem("user")?JSON.parse(localStorage.getItem("user")):null}))}}},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r=n("ade3"),o={class:"row"},c={key:0,class:"col-12 modal-alerts"},l={class:"row"},s={class:"col-12 mb-2"},u={class:"input-group"},i={type:"password",id:"password-1",ref:"password",placeholder:"Mot de passe",class:"form-control"},d={class:"col-12 mb-2"},b={class:"input-group"},p={type:"password",id:"password-2",ref:"password2",placeholder:"Confirmer le mot de passe",class:"form-control"},g={class:"col-12 mb-2"};function f(e,t,n,f,v,j){var O=Object(a["A"])("Menu"),h=Object(a["A"])("menu-unlogged"),m=Object(a["A"])("router-view"),_=Object(a["A"])("Modal"),y=Object(a["A"])("Loader");return Object(a["s"])(),Object(a["d"])(a["a"],null,[f.logged?(Object(a["s"])(),Object(a["d"])(O,{key:0,onModalOpened:f.on_modal_opened},null,8,["onModalOpened"])):Object(a["e"])("",!0),f.logged?Object(a["e"])("",!0):(Object(a["s"])(),Object(a["d"])(h,{key:1})),Object(a["g"])(m,{onModalOpened:f.on_modal_opened,onModalClosed:f.on_modal_closed},null,8,["onModalOpened","onModalClosed"]),Object(a["g"])(_,{title:"Profile",body_title:"Modifier mon mot de passe",opened:f.password_modal_opened,onClose:f.close_password_modal},{default:Object(a["F"])((function(){return[Object(a["g"])("div",o,[f.alert.show?(Object(a["s"])(),Object(a["d"])("div",c,[Object(a["g"])("div",{class:Object(r["a"])({alert:!0},"alert-".concat(f.alert.type),!0),role:"alert"},Object(a["C"])(f.alert.text),3)])):Object(a["e"])("",!0)]),Object(a["g"])("form",l,[Object(a["g"])("div",s,[Object(a["g"])("div",u,[Object(a["g"])("input",i,null,512),Object(a["g"])("button",{class:"input-group-text fas fa-eye toggle-password",onClick:t[1]||(t[1]=Object(a["G"])((function(){return f.toggle_password_field_type&&f.toggle_password_field_type.apply(f,arguments)}),["prevent","stop"]))})])]),Object(a["g"])("div",d,[Object(a["g"])("div",b,[Object(a["g"])("input",p,null,512),Object(a["g"])("button",{class:"input-group-text fas fa-eye toggle-password",onClick:t[2]||(t[2]=Object(a["G"])((function(){return f.toggle_password_field_type&&f.toggle_password_field_type.apply(f,arguments)}),["prevent","stop"]))})])]),Object(a["g"])("div",g,[Object(a["g"])("button",{type:"submit",class:"btn btn-info",onClick:t[3]||(t[3]=Object(a["G"])((function(){return f.update_password&&f.update_password.apply(f,arguments)}),["prevent","stop"]))},"Modifier")])])]})),_:1},8,["opened","onClose"]),Object(a["g"])(y,{visible:f.loader_visible},null,8,["visible"])],64)}n("d3b7");var v=n("6c02"),j=(n("9911"),Object(a["H"])("data-v-e618df60"));Object(a["v"])("data-v-e618df60");var O={class:"navbar navbar-expand-lg navbar-light bg-light",style:{width:"100hh"}},h={class:"container-fluid"},m={class:"navbar-brand d-flex flex-column flex-md-row align-items-start align-items-md-center",href:"/"},_={class:"d-flex justify-content-center align-items-center"},y=Object(a["g"])("img",{src:"https://avatars.githubusercontent.com/u/2487851?s=280&v=4",alt:"Logo norsys",width:"50",height:"50",class:"d-inline-block align-top mx-2"},null,-1),w={class:"d-flex flex-column"},k={class:"d-inline-block"},x={id:"today"},D={key:0,class:"d-flex align-items-center justify-content-center mx-3 d-lg-none"},C=Object(a["g"])("i",{class:"fas fa-chevron-left"},null,-1),M=Object(a["g"])("i",{class:"fas fa-chevron-right"},null,-1),S=Object(a["g"])("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},[Object(a["g"])("span",{class:"navbar-toggler-icon"})],-1),L={class:"collapse navbar-collapse",id:"navbarTogglerDemo02",ref:"menu"},A={class:"navbar-nav me-auto mb-2 mb-lg-0"},I={key:2,class:"dropdown-menu norsys-dropdown-content","aria-labelledby":"navbarScrollingDropdown",style:{"max-height":"200px","overflow-y":"auto","min-width":"220px"}},H={class:"d-flex"},N={key:0,class:"d-none d-lg-flex align-items-center justify-content-center"},G=Object(a["g"])("i",{class:"fas fa-chevron-left"},null,-1),F=Object(a["g"])("i",{class:"fas fa-chevron-right"},null,-1),J=Object(a["g"])("i",{class:"fas fa-power-off"},null,-1),P={id:"full-name"},Y=Object(a["f"])(" | ");Object(a["t"])();var q=j((function(e,t,n,r,o,c){return Object(a["s"])(),Object(a["d"])("nav",O,[Object(a["g"])("div",h,[Object(a["g"])("a",m,[Object(a["g"])("div",_,[y,Object(a["g"])("div",w,[Object(a["g"])("span",k,Object(a["C"])(r.page),1),Object(a["g"])("strong",x,Object(a["C"])(r.format_date),1)])]),r.is_calendar_page()?(Object(a["s"])(),Object(a["d"])("div",D,[Object(a["g"])("button",{type:"button",class:"btn btn-info mr-1 previous-month",onClick:t[1]||(t[1]=Object(a["G"])((function(){return r.previous_month&&r.previous_month.apply(r,arguments)}),["prevent","stop"]))},[C]),Object(a["g"])("button",{type:"button",class:"btn btn-info mr-1 next-month",onClick:t[2]||(t[2]=Object(a["G"])((function(){return r.next_month&&r.next_month.apply(r,arguments)}),["prevent","stop"]))},[M])])):Object(a["e"])("",!0)]),S,Object(a["g"])("div",L,[Object(a["g"])("ul",A,[(Object(a["s"])(!0),Object(a["d"])(a["a"],null,Object(a["y"])(r.links,(function(e){return Object(a["s"])(),Object(a["d"])("li",{class:{"nav-item":!0,dropdown:!0===e.dropdown,"norsys-dropdown":!0===e.dropdown},key:e.id},[e.dropdown?e.dropdown&&e.visible()?(Object(a["s"])(),Object(a["d"])("a",{key:1,href:"#",class:"nav-link dropdown-toggle",role:"button",id:"navbarScrollingDropdown",onClick:t[3]||(t[3]=Object(a["G"])((function(){return r.toggle_dropdown&&r.toggle_dropdown.apply(r,arguments)}),["prevent","stop"])),"data-bs-toggle":"dropdown","aria-expanded":r.dropdown_aria_expended?"true":"false"},Object(a["C"])(e.label),9,["aria-expanded"])):Object(a["e"])("",!0):(Object(a["s"])(),Object(a["d"])("a",{key:0,href:e.link,onClick:Object(a["G"])((function(t){return r.change_page({link:e.link})}),["prevent","stop"]),class:{"nav-link":!0,active:r.is_active({link:e.link})},"aria-current":r.aria_current(e)},Object(a["C"])(e.label),11,["href","onClick","aria-current"])),e.dropdown&&e.visible()?(Object(a["s"])(),Object(a["d"])("ul",I,[(Object(a["s"])(!0),Object(a["d"])(a["a"],null,Object(a["y"])(r.historique,(function(e){return Object(a["s"])(),Object(a["d"])("li",{key:e,class:{active:"Aujourd'hui"===r.format_historique_date_to_write(e)}},[Object(a["g"])("a",{href:"#",class:"dropdown-item","data-date":e,onClick:t[4]||(t[4]=Object(a["G"])((function(){return r.historique_date_handle&&r.historique_date_handle.apply(r,arguments)}),["prevent","stop"]))},Object(a["C"])(r.format_historique_date_to_write(e)),9,["data-date"])],2)})),128))])):Object(a["e"])("",!0)],2)})),128))]),Object(a["g"])("div",H,[r.is_calendar_page()?(Object(a["s"])(),Object(a["d"])("div",N,[Object(a["g"])("button",{type:"button",class:"btn btn-info mx-1 previous-month",onClick:t[5]||(t[5]=Object(a["G"])((function(){return r.previous_month&&r.previous_month.apply(r,arguments)}),["prevent","stop"]))},[G]),Object(a["g"])("button",{type:"button",class:"btn btn-info mx-1 next-month",onClick:t[6]||(t[6]=Object(a["G"])((function(){return r.next_month&&r.next_month.apply(r,arguments)}),["prevent","stop"]))},[F])])):Object(a["e"])("",!0),Object(a["g"])("a",{href:"#",class:"btn btn-secondary",id:"profile",onClick:t[8]||(t[8]=Object(a["G"])((function(){return r.open_profile_modal&&r.open_profile_modal.apply(r,arguments)}),["prevent","stop"]))},[Object(a["g"])("button",{class:"btn btn-danger",id:"logout",style:{position:"relative","z-index":"1"},onClick:t[7]||(t[7]=Object(a["G"])((function(){return r.logout&&r.logout.apply(r,arguments)}),["prevent","stop"]))},[J]),Object(a["g"])("span",P,Object(a["C"])(r.full_name),1),Y,Object(a["g"])("strong",null,Object(a["C"])(r.agency),1)])])],512)])])})),E=(n("99af"),n("4360")),T={name:"Menu",props:{page_title:{type:String,default:"Fiche de présence"}},setup:function(e,t){var n=t.emit,r=Object(E["f"])(),o=r.updatePresences,c=Object(E["b"])(),l=c.updateChoosenDate,s=c.choosen_date,u=Object(E["a"])(),i=u.calendar_date,d=u.nextDate,b=u.previousDate,p=u.setCalendar,g=u.setNbDays,f=Object(E["g"])(),j=f.toggle,O=Object(E["e"])(),h=O.setLogged,m=Object(E["d"])(),_=m.show_loader,y=m.hide_loader,w=Object(E["c"])(),k=w.api_base,x=w.days,D=w.months,C=Object(v["c"])(),M=Object(a["x"])(new Date),S=Object(a["x"])(e.page_title),L=Object(a["x"])(!1),A=Object(a["x"])([]),I=Object(a["x"])(null),H=function(e){var t=e.link;return C.push({path:t})},N=function(e){var t=e.link;return t===C.currentRoute.value.fullPath},G=function(e){return N(e)?"page":"false"},F=function(){fetch(k+"/search/history").then((function(e){return e.json()})).then((function(e){A.value=e}))},J=function(e){var t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1<10?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<10?"0":"")+t.getDate(),a=new Date(e);return a=x[a.getDay()]+" "+a.getDate()+" "+D[a.getMonth()+1]+" "+a.getFullYear(),e===n?"Aujourd'hui":a},P=function(e){fetch(k+"/search/history/"+e.target.getAttribute("data-date")).then((function(e){return e.json()})).then((function(t){o(t),l(e.target.getAttribute("data-date")),e.target.parentElement.classList.add("active"),M.value=new Date(e.target.getAttribute("data-date"))}))},Y=function(){return N({link:"/calendar"})},q=function(){b(),_(),fetch("".concat(k,"/calendar/").concat(i.value.year,"/").concat(i.value.month)).then((function(e){return e.json()})).then((function(e){p(e.calendar),g(e.nb_days.previous,e.nb_days.next),y()}))},T=function(){d(),_(),fetch("".concat(k,"/calendar/").concat(i.value.year,"/").concat(i.value.month)).then((function(e){return e.json()})).then((function(e){p(e.calendar),g(e.nb_days.previous,e.nb_days.next),y()}))},B=function(){j(),n("modal-opened")},U=function(){localStorage.removeItem("user"),h(!1),C.push("/login")},R=function(){L.value=!L.value},z=function(){I.value.classList.contains("show")?I.value.classList.remove("show"):I.value.classList.add("show")};return F(),{page:S,dropdown_aria_expended:L,historique:A,date:s,days:x,months:D,links:[{id:0,label:"Accueil",link:"/"},{id:1,label:"Calendrier / Réservations",link:"/calendar"},{id:2,label:"Historique",dropdown:!0,visible:function(){return N({link:"/"})}},{id:3,label:"Récaps hebdo",link:"/recap/list"},{id:4,label:"Nouveau Récap hebdo",link:"/recap/edit"}],menu:I,format_date:Object(a["b"])((function(){return x[M.value.getDay()]+" "+M.value.getDate()+" "+D[M.value.getMonth()+1]+" "+M.value.getFullYear()})),agency:Object(a["b"])((function(){return JSON.parse(localStorage.getItem("user")).agency})),full_name:Object(a["b"])((function(){return JSON.parse(localStorage.getItem("user")).lastname+" "+JSON.parse(localStorage.getItem("user")).firstname.substr(0,1)+"."})),change_page:H,is_active:N,aria_current:G,format_historique_date_to_write:J,historique_date_handle:P,is_calendar_page:Y,next_month:T,previous_month:q,open_profile_modal:B,logout:U,toggle_dropdown:R,toggle_menu:z}}};n("ddad");T.render=q,T.__scopeId="data-v-e618df60";var B=T,U=n("714b"),R=Object(a["H"])("data-v-c65888a8");Object(a["v"])("data-v-c65888a8");var z=Object(a["g"])("div",{class:"spinner-border",role:"status"},[Object(a["g"])("span",{class:"visually-hidden"},"Loading...")],-1);Object(a["t"])();var K=R((function(e,t,n,r,o,c){return Object(a["s"])(),Object(a["d"])("div",{class:{loader:!0,"d-none":!n.visible,"d-flex":n.visible,"align-items-center":!0,"justify-content-center":!0}},[z],2)})),V={name:"Loader",props:{visible:{type:Boolean,default:!1}}};n("16df");V.render=K,V.__scopeId="data-v-c65888a8";var $=V,Q={class:"navbar navbar-light bg-light"},W={class:"container-fluid"},X={class:"navbar-brand d-flex justify-content-center align-items-center",href:"#"},Z=Object(a["g"])("img",{src:"https://avatars.githubusercontent.com/u/2487851?s=280&v=4",alt:"Logo norsys",width:"100",height:"100",class:"d-inline-block align-top"},null,-1),ee={class:"d-flex flex-column mx-3"},te=Object(a["g"])("h1",null,"Fiche de présence",-1);function ne(e,t,n,r,o,c){return Object(a["s"])(),Object(a["d"])("nav",Q,[Object(a["g"])("div",W,[Object(a["g"])("a",X,[Z,Object(a["g"])("div",ee,[te,Object(a["g"])("h2",null,Object(a["C"])(n.body_title),1)])])])])}var ae={name:"MenuUnlogged",props:{body_title:String}};ae.render=ne;var re=ae,oe={name:"App",components:{Modal:U["a"],Menu:B,MenuUnlogged:re,Loader:$},setup:function(){var e=Object(v["c"])(),t=Object(E["g"])(),n=t.opened,r=t.toggle,o=Object(E["e"])(),c=o.logged,l=Object(E["d"])(),s=l.loader_visible,u=Object(E["c"])(),i=u.api_base,d=u.user,b=Object(a["x"])({text:"",type:"",show:!1}),p=Object(a["x"])(null),g=Object(a["x"])(null),f=function(){return document.querySelector("body").style.overflowY="hidden"},j=function(){return document.querySelector("body").style.overflowY="auto"},O=function(){r(),j()},h=function(){var t=d.value.id;p.value.value!==g.value.value?(g.value.classList.add("is-invalid"),b.value={text:"Les 2 mots de passes ne sont pas identiques",type:"danger",show:!0}):fetch("".concat(i,"/user/password"),{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify({method:"put",user_id:t,password:p.value.value})}).then((function(e){return e.json()})).then((function(t){t.error?(g.value.classList.remove("is-valid"),g.value.classList.add("is-invalid"),p.value.classList.remove("is-valid"),p.value.classList.add("is-invalid"),b.value={text:t.message,type:"danger",show:!0}):(g.value.classList.remove("is-invalid"),g.value.classList.add("is-valid"),b.value.show&&(b.value.show=!1),localStorage.removeItem("user"),e.push("/login?passwordUpdated=true"))}))},m=function(e){e.target.previousElementSibling.setAttribute("type","password"===e.target.previousElementSibling.getAttribute("type")?"text":"password")};return{password_modal_opened:n,logged:c,loader_visible:s,alert:b,password:p,password2:g,on_modal_opened:f,on_modal_closed:j,close_password_modal:O,update_password:h,toggle_password_field_type:m}}};oe.render=f;var ce=oe,le=(n("3ca3"),n("ddb0"),{class:"container-fluid mt-2"}),se={class:"row"},ue={class:"col-6 col-md-2 col-lg-1"},ie={class:"col-6 col-md-2 col-lg-1"},de={class:"container"},be={class:"row"},pe={class:"col-12 page-alerts"},ge={class:"table table-responsive"},fe=Object(a["g"])("thead",null,[Object(a["g"])("tr",null,[Object(a["g"])("th",null,"Date"),Object(a["g"])("th",null,"Prénom Nom"),Object(a["g"])("th",null,"Heure d'arrivée"),Object(a["g"])("th",null,"Heure de départ")])],-1),ve={key:0},je=Object(a["g"])("tr",null,[Object(a["g"])("td",{colspan:"4",style:{"text-align":"center"}},[Object(a["g"])("strong",null,"Personne à l'agence aujourd'hui")])],-1),Oe={key:1},he={colspan:"4"},me=Object(a["g"])("i",{class:"fas fa-file-pdf"},null,-1),_e=Object(a["g"])("i",{class:"fas fa-print"},null,-1);function ye(e,t,n,o,c,l){var s=Object(a["A"])("fragment");return Object(a["s"])(),Object(a["d"])(s,null,{default:Object(a["F"])((function(){var n;return[Object(a["g"])("div",le,[Object(a["g"])("div",se,[Object(a["g"])("div",ue,[o.is_arrived(o.presences)?(Object(a["s"])(),Object(a["d"])("button",{key:0,ref:"arrival_btn",class:"btn btn-success btn-disabled",onClick:t[1]||(t[1]=Object(a["G"])((function(){return o.on_arrival&&o.on_arrival.apply(o,arguments)}),["prevent","stop"])),disabled:"disabled"},"Arrivée",512)):(Object(a["s"])(),Object(a["d"])("button",{key:1,ref:"arrival_btn",class:"btn btn-success",onClick:t[2]||(t[2]=Object(a["G"])((function(){return o.on_arrival&&o.on_arrival.apply(o,arguments)}),["prevent","stop"]))},"Arrivée",512))]),Object(a["g"])("div",ie,[o.is_out(o.presences)?(Object(a["s"])(),Object(a["d"])("button",{key:0,ref:"departure_btn",class:"btn btn-success btn-disabled",onClick:t[3]||(t[3]=Object(a["G"])((function(){return o.on_departure&&o.on_departure.apply(o,arguments)}),["prevent","stop"])),disabled:"disabled"},"Départ",512)):(Object(a["s"])(),Object(a["d"])("button",{key:1,ref:"departure_btn",class:"btn btn-success",onClick:t[4]||(t[4]=Object(a["G"])((function(){return o.on_departure&&o.on_departure.apply(o,arguments)}),["prevent","stop"]))},"Départ",512))])])]),Object(a["g"])("div",de,[Object(a["g"])("div",be,[Object(a["g"])("div",pe,[o.alert.show?(Object(a["s"])(),Object(a["d"])("div",{key:0,class:(n={alert:!0},Object(r["a"])(n,"alert-"+o.alert.type,!0),Object(r["a"])(n,"mt-1",!0),n),role:"alert"},Object(a["C"])(o.alert.text),3)):Object(a["e"])("",!0)])])]),Object(a["g"])("table",ge,[fe,0===o.presences.length?(Object(a["s"])(),Object(a["d"])("tbody",ve,[je])):(Object(a["s"])(),Object(a["d"])("tbody",Oe,[(Object(a["s"])(!0),Object(a["d"])(a["a"],null,Object(a["y"])(o.presences,(function(e){return Object(a["s"])(),Object(a["d"])("tr",{key:e.id},[Object(a["g"])("td",null,Object(a["C"])(o.date_format(e.arrival_date)),1),Object(a["g"])("td",null,Object(a["C"])(o.full_name(e.firstname,e.lastname)),1),Object(a["g"])("td",null,Object(a["C"])(o.get_arrival(e.arrival_date)),1),Object(a["g"])("td",null,Object(a["C"])(o.get_departure(e.departure_date)),1)])})),128))])),Object(a["g"])("tfoot",null,[Object(a["g"])("tr",null,[Object(a["g"])("td",he,[Object(a["g"])("button",{type:"button",onClick:t[5]||(t[5]=Object(a["G"])((function(){return o.export_pdf&&o.export_pdf.apply(o,arguments)}),["prevent","stop"])),class:"btn btn-success mx-1"},[me]),Object(a["g"])("button",{type:"button",onClick:t[6]||(t[6]=Object(a["G"])((function(){var t;return e.window.print&&(t=e.window).print.apply(t,arguments)}),["prevent","stop"])),class:"btn btn-success mx-1"},[_e])])])])])]})),_:1})}var we=n("5530"),ke=(n("13d5"),{name:"Home",setup:function(){var e=Object(v["c"])(),t=Object(E["c"])(),n=t.api_base,r=t.user;null===r.value&&e.push("/login");var o=r.value,c=o.id,l=o.email,s=Object(E["f"])(),u=s.presences,i=s.updatePresences,d=Object(E["b"])(),b=d.choosen_date,p=Object(E["d"])(),g=p.show_loader,f=p.hide_loader,j=Object(a["x"])(null),O=Object(a["x"])(null),h=Object(a["x"])({show:!1,text:"",type:"info"}),m=function(e){return e=new Date(e),(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)+"/"+e.getFullYear()},_=function(e,t){return t+" "+e.substr(0,1)+"."},y=function(e){return e=new Date(e),(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())},w=function(e){return null===e?"":(e=new Date(e),(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()))},k=function(){fetch(n+"/presence",{method:"post",body:JSON.stringify({type:"arrival",user_id:c})}).then((function(e){return e.json()})).then((function(e){e.error||S().then((function(){j.value.classList.add("btn-disabled"),j.value.setAttribute("disabled","disabled"),O.value.classList.remove("btn-disabled"),O.value.removeAttribute("disabled")}))}))},x=function(){fetch(n+"/presence",{method:"post",body:JSON.stringify({type:"departure",user_id:c})}).then((function(e){return e.json()})).then((function(e){e.error||S().then((function(){O.value.classList.add("btn-disabled"),O.value.setAttribute("disabled","disabled")}))}))},D=function(e){return e.reduce((function(e,t){return t.firstname===JSON.parse(localStorage.getItem("user")).firstname&&t.lastname===JSON.parse(localStorage.getItem("user")).lastname&&(e=!0),e}),!1)},C=function(e){return e.reduce((function(e,t){var n=null!==t.departure_date?(parseInt(new Date(t.departure_date).getHours())<10?"0"+new Date(t.departure_date).getHours():new Date(t.departure_date).getHours())+":"+(parseInt(new Date(t.departure_date).getMinutes())<10?"0"+new Date(t.departure_date).getMinutes():new Date(t.departure_date).getMinutes()):"";return t.firstname===JSON.parse(localStorage.getItem("user")).firstname&&t.lastname===JSON.parse(localStorage.getItem("user")).lastname&&n&&(e=!0),e}),!1)},M=function(){var e=b.value;g(),fetch(n+"/export/"+e,{method:"post",body:JSON.stringify({email:l})}).then((function(e){return e.json()})).then((function(e){e.error?h.value={show:!0,text:e.message,type:"danger"}:h.value={show:!0,text:"Un email vous à  été envoyé avec l'export en pièce jointe",type:"success"},f();var t=setTimeout((function(){h.value=Object(we["a"])(Object(we["a"])({},h.value),{},{show:!1}),clearTimeout(t)}),3e3)}))},S=function(){return g(),fetch(n+"/search/history/"+b.value).then((function(e){return e.json()})).then((function(e){return i(e),f(),!0}))};return S(),setInterval(S,3e5),Object(a["n"])((function(){localStorage.getItem("user")||e.push("/login")})),{presences:u,arrival_btn:j,departure_btn:O,alert:h,date_format:m,full_name:_,get_arrival:y,get_departure:w,is_arrived:D,is_out:C,export_pdf:M,on_arrival:k,on_departure:x}}});ke.render=ye;var xe=ke,De=[{path:"/",name:"Home",component:xe},{path:"/calendar",name:"Calendar",component:function(){return n.e("chunk-4b0db170").then(n.bind(null,"ac0f"))}},{path:"/recap/list",name:"recapHistorique",component:function(){return n.e("chunk-2d0c4fa8").then(n.bind(null,"3cac"))}},{path:"/recap/:id",name:"recap",component:function(){return n.e("chunk-52d5452e").then(n.bind(null,"a729"))},props:!0},{path:"/recap/edit",name:"recapEdition",component:function(){return n.e("chunk-2b7c4a34").then(n.bind(null,"45ed"))}},{path:"/login",name:"login",component:function(){return n.e("chunk-2d2086b7").then(n.bind(null,"a55b"))}},{path:"/register",name:"register",component:function(){return n.e("chunk-2d0d6d35").then(n.bind(null,"73cf"))}}],Ce=Object(v["a"])({history:Object(v["b"])("/"),mode:"history",routes:De}),Me=Ce;Object(a["c"])(ce).use(Me).mount("#app")},"63b7":function(e,t,n){},"714b":function(e,t,n){"use strict";var a=n("7a23"),r=Object(a["H"])("data-v-b4bcdc36");Object(a["v"])("data-v-b4bcdc36");var o={class:"modal-header"},c={class:"modal-title"},l={class:"modal-body"},s={class:"container"},u={class:"row"},i={class:"col-12"};Object(a["t"])();var d=r((function(e,t,n,r,d,b){return Object(a["s"])(),Object(a["d"])("div",{ref:"modalEl",onClick:t[2]||(t[2]=Object(a["G"])((function(){return r.close&&r.close.apply(r,arguments)}),["prevent","stop"])),class:{"norsys-modal":!0,opened:n.opened}},[Object(a["g"])("div",{class:"modal-content",onClick:Object(a["G"])(!1,["prevent","stop"])},[Object(a["g"])("div",o,[Object(a["g"])("h1",c,Object(a["C"])(n.title),1),Object(a["g"])("a",{href:"#",onClick:t[1]||(t[1]=Object(a["G"])((function(){return r.close&&r.close.apply(r,arguments)}),["prevent","stop"])),class:"btn-close"})]),Object(a["g"])("div",l,[Object(a["g"])("div",s,[Object(a["g"])("div",u,[Object(a["g"])("div",i,[Object(a["g"])("h2",null,Object(a["C"])(n.body_title),1)])]),Object(a["z"])(e.$slots,"default",{},void 0,!0)])])],8,["onClick"])],2)})),b={name:"Modal",props:{title:{type:String},body_title:{type:String,default:""},opened:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,r=Object(a["x"])(null);return{modalEl:r,close:function(){return n("close")}}}};n("82ba");b.render=d,b.__scopeId="data-v-b4bcdc36";t["a"]=b},"82ba":function(e,t,n){"use strict";n("c4fd")},"84bd":function(e,t,n){},c4fd:function(e,t,n){},ddad:function(e,t,n){"use strict";n("63b7")}});
//# sourceMappingURL=app.1f9fe11a.js.map