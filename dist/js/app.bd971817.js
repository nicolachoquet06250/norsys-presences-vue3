(function(e){function t(t){for(var a,r,l=t[0],u=t[1],s=t[2],i=0,d=[];i<l.length;i++)r=l[i],Object.prototype.hasOwnProperty.call(o,r)&&o[r]&&d.push(o[r][0]),o[r]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);b&&b(t);while(d.length)d.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],a=!0,r=1;r<n.length;r++){var l=n[r];0!==o[l]&&(a=!1)}a&&(c.splice(t--,1),e=u(u.s=n[0]))}return e}var a={},r={app:0},o={app:0},c=[];function l(e){return u.p+"js/"+({}[e]||e)+"."+{"chunk-2b7c4a34":"7890b1f4","chunk-2d0c4fa8":"11589626","chunk-2d0d6d35":"1fa41a32","chunk-2d2086b7":"19f22398","chunk-4b0db170":"7d8847a7","chunk-52d5452e":"aa6eff34"}[e]+".js"}function u(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(e){var t=[],n={"chunk-2b7c4a34":1,"chunk-4b0db170":1};r[e]?t.push(r[e]):0!==r[e]&&n[e]&&t.push(r[e]=new Promise((function(t,n){for(var a="css/"+({}[e]||e)+"."+{"chunk-2b7c4a34":"2214c610","chunk-2d0c4fa8":"31d6cfe0","chunk-2d0d6d35":"31d6cfe0","chunk-2d2086b7":"31d6cfe0","chunk-4b0db170":"1a3a86ec","chunk-52d5452e":"31d6cfe0"}[e]+".css",o=u.p+a,c=document.getElementsByTagName("link"),l=0;l<c.length;l++){var s=c[l],i=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(i===a||i===o))return t()}var d=document.getElementsByTagName("style");for(l=0;l<d.length;l++){s=d[l],i=s.getAttribute("data-href");if(i===a||i===o)return t()}var b=document.createElement("link");b.rel="stylesheet",b.type="text/css",b.onload=t,b.onerror=function(t){var a=t&&t.target&&t.target.src||o,c=new Error("Loading CSS chunk "+e+" failed.\n("+a+")");c.code="CSS_CHUNK_LOAD_FAILED",c.request=a,delete r[e],b.parentNode.removeChild(b),n(c)},b.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(b)})).then((function(){r[e]=0})));var a=o[e];if(0!==a)if(a)t.push(a[2]);else{var c=new Promise((function(t,n){a=o[e]=[t,n]}));t.push(a[2]=c);var s,i=document.createElement("script");i.charset="utf-8",i.timeout=120,u.nc&&i.setAttribute("nonce",u.nc),i.src=l(e);var d=new Error;s=function(t){i.onerror=i.onload=null,clearTimeout(b);var n=o[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),r=t&&t.target&&t.target.src;d.message="Loading chunk "+e+" failed.\n("+a+": "+r+")",d.name="ChunkLoadError",d.type=a,d.request=r,n[1](d)}o[e]=void 0}};var b=setTimeout((function(){s({type:"timeout",target:i})}),12e4);i.onerror=i.onload=s,document.head.appendChild(i)}return Promise.all(t)},u.m=e,u.c=a,u.d=function(e,t,n){u.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},u.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,t){if(1&t&&(e=u(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)u.d(n,a,function(t){return e[t]}.bind(null,a));return n},u.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return u.d(t,"a",t),t},u.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},u.p="/",u.oe=function(e){throw console.error(e),e};var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var b=i;c.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"16df":function(e,t,n){"use strict";n("84bd")},4360:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"d",(function(){return g})),n.d(t,"e",(function(){return _})),n.d(t,"g",(function(){return D})),n.d(t,"f",(function(){return S})),n.d(t,"c",(function(){return C}));var a=n("b85c"),r=n("2909"),o=(n("d81d"),n("d3b7"),n("ddb0"),n("99af"),n("13d5"),n("b64b"),n("7a23")),c=Object(o["y"])(new Date),l=Object(o["y"])({}),u=Object(o["y"])({year:(new Date).getFullYear(),month:(new Date).getMonth(),full_current_date:new Date}),s=Object(o["y"])({previous:null,current:null}),i=Object(o["y"])({});function d(){var e=function(e,t){return Object(r["a"])(Array(t-e).keys()).map((function(t){return t+e}))};function t(){var e;e=c.value.getMonth()+1===12?new Date(c.value.getFullYear()+1,0):new Date(c.value.getFullYear(),c.value.getMonth()+1),b(e.getFullYear(),e.getMonth()+1),c.value=e}function n(){var e;e=c.value.getMonth()+1===1?new Date(c.value.getFullYear()-1,11):new Date(c.value.getFullYear(),c.value.getMonth()-1),b(e.getFullYear(),e.getMonth()+1),c.value=e}function d(e){l.value=e}function b(e,t){u.value={full_current_date:u.value.full_current_date,year:e,month:t}}function p(e,t){s.value={previous:e,current:t}}function f(e){return e=new Date(e),e="".concat(e.getFullYear(),"-").concat(e.getMonth()+1<10?"0":"").concat(e.getMonth()+1,"-").concat(e.getDate()<10?"0":"").concat(e.getDate()),Object.keys(i.value).reduce((function(t,n){return n===e&&(t=n),t}),!1)}function h(e){return f(e)?i.value[e]:""}function v(){fetch("https://calendrier.api.gouv.fr/jours-feries/metropole/".concat(u.value.year,".json")).then((function(e){return e.json()})).then((function(e){i.value=e}))}return null!==u.value.year&&v(),{current_date:Object(o["b"])((function(){return c.value})),calendar:Object(o["b"])((function(){var t,n=l.value,o=s.value.previous,c=1===u.value.month?Object.keys(n):Object.keys(n).map((function(e){return parseInt(e)})).sort((function(e,t){return e-t})),i=0,d=Object(a["a"])(c);try{for(d.s();!(t=d.n()).done;){var b=t.value,p="number"===typeof b?"".concat(b<10?"0":"").concat(b):b;n[p]=n[p].reduce((function(e,t){return t.day<6&&e.push(t),e}),[]);var f=n[p];if(0===i&&f.length<5){for(var h=0,v=f[0]?f[0].day:1,j=0;j<v-1;j++)h++;o-=h;var O=[];for(var g in e(1,h+1)){var m=new Date;m.setYear(12===parseInt(u.value.month)?parseInt(u.value.year)+1:u.value.year),m.setMonth(12===parseInt(u.value.month)?1:u.value.month+1),m.setDate(o),O.push({date:"".concat(m.getFullYear(),"-").concat(m.getMonth()<10?"0":"").concat(m.getMonth(),"-").concat(m.getDate()<10?"0":"").concat(m.getDate()),day:g,presences:[],reservations:[],external_day:!0}),o++}n[p]=[].concat(O,Object(r["a"])(f))}if(i===c.length-1&&f.length<5)for(var y=5-f.length,_=f[f.length-1].day,w=1;w<=y;w++)n[p].push({date:"--".concat(w),day:_,presences:[],reservations:[],external_day:!0}),_++;i++}}catch(k){d.e(k)}finally{d.f()}return n})),calendar_date:Object(o["b"])((function(){return u.value})),nb_days:Object(o["b"])((function(){return s.value})),bank_holidays:Object(o["b"])((function(){return i.value})),nextDate:t,previousDate:n,setCalendar:d,setCalendarDate:b,setNbDays:p,registerBankHoliday:v,isBankHoliday:f,getBankHolidayLabel:h}}var b=d,p=new Date,f=Object(o["y"])(p.getFullYear()+"-"+(p.getMonth()+1<10?"0":"")+(p.getMonth()+1)+"-"+(p.getDate()<10?"0":"")+p.getDate());function h(){return{choosen_date:Object(o["b"])((function(){return f.value})),updateChoosenDate:function(e){f.value=e}}}var v=h,j=Object(o["y"])(!1),O=function(){return{loader_visible:Object(o["b"])((function(){return j.value})),show_loader:function(){j.value=!0},hide_loader:function(){j.value=!1},toggle_loader:function(){j.value=!0!==j.value}}},g=O,m=Object(o["y"])(null!==localStorage.getItem("user")),y=function(){return{logged:Object(o["b"])((function(){return m.value})),setLogged:function(e){m.value=e}}},_=y,w=Object(o["y"])(!1),k=function(){var e=function(){w.value=!w.value},t=function(){w.value=!1};return{opened:Object(o["b"])((function(){return w.value})),toggle:e,reset:t}},D=k,x=Object(o["y"])([]);function M(){return{presences:Object(o["b"])((function(){return x.value})),updatePresences:function(e){x.value=e}}}var S=M,C=function(){var e="https://norsys-sophia-presence.nicolaschoquet.fr";return{url_base:e,api_base:"".concat(e,"/api"),days:["","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],months:["","Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],user:Object(o["b"])((function(){return JSON.parse(localStorage.getItem("user"))}))}}},4663:function(e,t,n){"use strict";n("e4da")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var a=n("7a23"),r=n("ade3"),o={class:"row"},c={key:0,class:"col-12 modal-alerts"},l={class:"row"},u={class:"col-12 mb-2"},s={class:"input-group"},i={type:"password",id:"password-1",ref:"password",placeholder:"Mot de passe",class:"form-control"},d={class:"col-12 mb-2"},b={class:"input-group"},p={type:"password",id:"password-2",ref:"password2",placeholder:"Confirmer le mot de passe",class:"form-control"},f={class:"col-12 mb-2"};function h(e,t,n,h,v,j){var O=Object(a["B"])("Menu"),g=Object(a["B"])("menu-unlogged"),m=Object(a["B"])("router-view"),y=Object(a["B"])("Modal"),_=Object(a["B"])("Loader");return Object(a["t"])(),Object(a["d"])(a["a"],null,[h.logged?(Object(a["t"])(),Object(a["d"])(O,{key:0,onModalOpened:h.on_modal_opened},null,8,["onModalOpened"])):Object(a["e"])("",!0),h.logged?Object(a["e"])("",!0):(Object(a["t"])(),Object(a["d"])(g,{key:1})),Object(a["h"])(m,{onModalOpened:h.on_modal_opened,onModalClosed:h.on_modal_closed},null,8,["onModalOpened","onModalClosed"]),Object(a["h"])(y,{title:"Profile",body_title:"Modifier mon mot de passe",opened:h.password_modal_opened,onClose:h.close_password_modal},{default:Object(a["G"])((function(){return[Object(a["h"])("div",o,[h.alert.show?(Object(a["t"])(),Object(a["d"])("div",c,[Object(a["h"])("div",{class:Object(r["a"])({alert:!0},"alert-".concat(h.alert.type),!0),role:"alert"},Object(a["D"])(h.alert.text),3)])):Object(a["e"])("",!0)]),Object(a["h"])("form",l,[Object(a["h"])("div",u,[Object(a["h"])("div",s,[Object(a["h"])("input",i,null,512),Object(a["h"])("button",{class:"input-group-text fas fa-eye toggle-password",onClick:t[1]||(t[1]=Object(a["H"])((function(){return h.toggle_password_field_type&&h.toggle_password_field_type.apply(h,arguments)}),["prevent","stop"]))})])]),Object(a["h"])("div",d,[Object(a["h"])("div",b,[Object(a["h"])("input",p,null,512),Object(a["h"])("button",{class:"input-group-text fas fa-eye toggle-password",onClick:t[2]||(t[2]=Object(a["H"])((function(){return h.toggle_password_field_type&&h.toggle_password_field_type.apply(h,arguments)}),["prevent","stop"]))})])]),Object(a["h"])("div",f,[Object(a["h"])("button",{type:"submit",class:"btn btn-info",onClick:t[3]||(t[3]=Object(a["H"])((function(){return h.update_password&&h.update_password.apply(h,arguments)}),["prevent","stop"]))},"Modifier")])])]})),_:1},8,["opened","onClose"]),Object(a["h"])(_,{visible:h.loader_visible},null,8,["visible"])],64)}n("d3b7");var v=n("6c02"),j=(n("9911"),Object(a["I"])("data-v-cfb352ba"));Object(a["w"])("data-v-cfb352ba");var O={class:"navbar navbar-expand-lg navbar-light bg-light",style:{width:"100hh"}},g={class:"container-fluid"},m={class:"navbar-brand d-flex flex-column flex-md-row align-items-start align-items-md-center",href:"/"},y={class:"d-flex justify-content-center align-items-center"},_=Object(a["h"])("img",{src:"https://avatars.githubusercontent.com/u/2487851?s=280&v=4",alt:"Logo norsys",width:"50",height:"50",class:"d-inline-block align-top mx-2"},null,-1),w={class:"d-flex flex-column"},k={class:"d-inline-block"},D={id:"today"},x={key:0,class:"d-flex align-items-center justify-content-center mx-3 d-lg-none"},M=Object(a["h"])("i",{class:"fas fa-chevron-left"},null,-1),S=Object(a["h"])("i",{class:"fas fa-chevron-right"},null,-1),C=Object(a["h"])("button",{class:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarTogglerDemo02","aria-controls":"navbarTogglerDemo02","aria-expanded":"false","aria-label":"Toggle navigation"},[Object(a["h"])("span",{class:"navbar-toggler-icon"})],-1),H={class:"collapse navbar-collapse",id:"navbarTogglerDemo02"},L={class:"navbar-nav me-auto mb-2 mb-lg-0"},I={key:2,class:"dropdown-menu norsys-dropdown-content","aria-labelledby":"navbarScrollingDropdown",style:{"max-height":"200px","overflow-y":"auto","min-width":"220px"}},A={class:"d-flex"},N={key:0,class:"d-none d-lg-flex align-items-center justify-content-center"},F=Object(a["h"])("i",{class:"fas fa-chevron-left"},null,-1),J=Object(a["h"])("i",{class:"fas fa-chevron-right"},null,-1),P=Object(a["h"])("i",{class:"fas fa-power-off"},null,-1),Y={id:"full-name"},q=Object(a["g"])(" | ");Object(a["u"])();var E=j((function(e,t,n,r,o,c){return Object(a["t"])(),Object(a["d"])("nav",O,[Object(a["h"])("div",g,[Object(a["h"])("a",m,[Object(a["h"])("div",y,[_,Object(a["h"])("div",w,[Object(a["h"])("span",k,Object(a["D"])(r.page),1),Object(a["h"])("strong",D,Object(a["D"])(r.format_date),1)])]),r.is_calendar_page()?(Object(a["t"])(),Object(a["d"])("div",x,[Object(a["h"])("button",{type:"button",class:"btn btn-info mr-1 previous-month",onClick:t[1]||(t[1]=Object(a["H"])((function(){return r.previous_month&&r.previous_month.apply(r,arguments)}),["prevent","stop"]))},[M]),Object(a["h"])("button",{type:"button",class:"btn btn-info mr-1 next-month",onClick:t[2]||(t[2]=Object(a["H"])((function(){return r.next_month&&r.next_month.apply(r,arguments)}),["prevent","stop"]))},[S])])):Object(a["e"])("",!0)]),C,Object(a["h"])("div",H,[Object(a["h"])("ul",L,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["z"])(r.links,(function(e){return Object(a["t"])(),Object(a["d"])("li",{class:{"nav-item":!0,dropdown:!0===e.dropdown,"norsys-dropdown":!0===e.dropdown},key:e.id},[e.dropdown?e.dropdown&&e.visible()?(Object(a["t"])(),Object(a["d"])("a",{key:1,href:"#",class:"nav-link dropdown-toggle",role:"button",id:"navbarScrollingDropdown",onClick:t[3]||(t[3]=Object(a["H"])((function(){return r.toggle_dropdown&&r.toggle_dropdown.apply(r,arguments)}),["prevent","stop"])),"data-bs-toggle":"dropdown","aria-expanded":r.dropdown_aria_expended?"true":"false"},Object(a["D"])(e.label),9,["aria-expanded"])):Object(a["e"])("",!0):(Object(a["t"])(),Object(a["d"])("a",{key:0,href:e.link,onClick:Object(a["H"])((function(t){return r.change_page({link:e.link})}),["prevent","stop"]),class:{"nav-link":!0,active:r.is_active({link:e.link})},"aria-current":r.aria_current(e)},Object(a["D"])(e.label),11,["href","onClick","aria-current"])),e.dropdown&&e.visible()?(Object(a["t"])(),Object(a["d"])("ul",I,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["z"])(r.historique,(function(e){return Object(a["t"])(),Object(a["d"])("li",{key:e,class:{active:"Aujourd'hui"===r.format_historique_date_to_write(e)}},[Object(a["h"])("a",{href:"#",class:"dropdown-item","data-date":e,onClick:t[4]||(t[4]=Object(a["H"])((function(){return r.historique_date_handle&&r.historique_date_handle.apply(r,arguments)}),["prevent","stop"]))},Object(a["D"])(r.format_historique_date_to_write(e)),9,["data-date"])],2)})),128))])):Object(a["e"])("",!0)],2)})),128))]),Object(a["h"])("div",A,[r.is_calendar_page()?(Object(a["t"])(),Object(a["d"])("div",N,[Object(a["h"])("button",{type:"button",class:"btn btn-info mx-1 previous-month",onClick:t[5]||(t[5]=Object(a["H"])((function(){return r.previous_month&&r.previous_month.apply(r,arguments)}),["prevent","stop"]))},[F]),Object(a["h"])("button",{type:"button",class:"btn btn-info mx-1 next-month",onClick:t[6]||(t[6]=Object(a["H"])((function(){return r.next_month&&r.next_month.apply(r,arguments)}),["prevent","stop"]))},[J])])):Object(a["e"])("",!0),Object(a["h"])("a",{href:"#",class:"btn btn-secondary",id:"profile",onClick:t[8]||(t[8]=Object(a["H"])((function(){return r.open_profile_modal&&r.open_profile_modal.apply(r,arguments)}),["prevent","stop"]))},[Object(a["h"])("button",{class:"btn btn-danger",id:"logout",style:{position:"relative","z-index":"1"},onClick:t[7]||(t[7]=Object(a["H"])((function(){return r.logout&&r.logout.apply(r,arguments)}),["prevent","stop"]))},[P]),Object(a["h"])("span",Y,Object(a["D"])(r.full_name),1),q,Object(a["h"])("strong",null,Object(a["D"])(r.agency),1)])])])])])})),B=(n("99af"),n("4360")),T={name:"Menu",props:{page_title:{type:String,default:"Fiche de présence"}},setup:function(e,t){var n=t.emit,r=Object(B["f"])(),o=r.updatePresences,c=Object(B["b"])(),l=c.updateChoosenDate,u=c.choosen_date,s=Object(B["a"])(),i=s.calendar_date,d=s.nextDate,b=s.previousDate,p=s.setCalendar,f=s.setNbDays,h=Object(B["g"])(),j=h.toggle,O=Object(B["e"])(),g=O.setLogged,m=Object(B["d"])(),y=m.show_loader,_=m.hide_loader,w=Object(B["c"])(),k=w.api_base,D=w.days,x=w.months,M=Object(v["c"])(),S=Object(a["y"])(new Date),C=Object(a["y"])(e.page_title),H=Object(a["y"])(!1),L=Object(a["y"])([]),I=function(e){var t=e.link;return M.push({path:t})},A=function(e){var t=e.link;return t===M.currentRoute.value.fullPath},N=function(e){return A(e)?"page":"false"},F=function(){fetch(k+"/search/history").then((function(e){return e.json()})).then((function(e){L.value=e}))},J=function(e){var t=new Date,n=t.getFullYear()+"-"+(t.getMonth()+1<10?"0":"")+(t.getMonth()+1)+"-"+(t.getDate()<10?"0":"")+t.getDate(),a=new Date(e);return a=D[a.getDay()]+" "+a.getDate()+" "+x[a.getMonth()+1]+" "+a.getFullYear(),e===n?"Aujourd'hui":a},P=function(e){fetch(k+"/search/history/"+e.target.getAttribute("data-date")).then((function(e){return e.json()})).then((function(t){o(t),l(e.target.getAttribute("data-date")),e.target.parentElement.classList.add("active"),S.value=new Date(e.target.getAttribute("data-date"))}))},Y=function(){return A({link:"/calendar"})},q=function(){b(),y(),fetch("".concat(k,"/calendar/").concat(i.value.year,"/").concat(i.value.month)).then((function(e){return e.json()})).then((function(e){p(e.calendar),f(e.nb_days.previous,e.nb_days.next),_()}))},E=function(){d(),y(),fetch("".concat(k,"/calendar/").concat(i.value.year,"/").concat(i.value.month)).then((function(e){return e.json()})).then((function(e){p(e.calendar),f(e.nb_days.previous,e.nb_days.next),_()}))},T=function(){j(),n("modal-opened")},U=function(){localStorage.removeItem("user"),g(!1),M.push("/login")},z=function(){H.value=!H.value};return F(),{page:C,dropdown_aria_expended:H,historique:L,date:u,days:D,months:x,links:[{id:0,label:"Accueil",link:"/"},{id:1,label:"Calendrier / Réservations",link:"/calendar"},{id:2,label:"Historique",dropdown:!0,visible:function(){return A({link:"/"})}},{id:3,label:"Récaps hebdo",link:"/recap/list"},{id:4,label:"Nouveau Récap hebdo",link:"/recap/edit"}],format_date:Object(a["b"])((function(){return D[S.value.getDay()]+" "+S.value.getDate()+" "+x[S.value.getMonth()+1]+" "+S.value.getFullYear()})),agency:Object(a["b"])((function(){return JSON.parse(localStorage.getItem("user")).agency})),full_name:Object(a["b"])((function(){return JSON.parse(localStorage.getItem("user")).lastname+" "+JSON.parse(localStorage.getItem("user")).firstname.substr(0,1)+"."})),change_page:I,is_active:A,aria_current:N,format_historique_date_to_write:J,historique_date_handle:P,is_calendar_page:Y,next_month:E,previous_month:q,open_profile_modal:T,logout:U,toggle_dropdown:z}}};n("4663");T.render=E,T.__scopeId="data-v-cfb352ba";var U=T,z=n("714b"),R=Object(a["I"])("data-v-c65888a8");Object(a["w"])("data-v-c65888a8");var G=Object(a["h"])("div",{class:"spinner-border",role:"status"},[Object(a["h"])("span",{class:"visually-hidden"},"Loading...")],-1);Object(a["u"])();var K=R((function(e,t,n,r,o,c){return Object(a["t"])(),Object(a["d"])("div",{class:{loader:!0,"d-none":!n.visible,"d-flex":n.visible,"align-items-center":!0,"justify-content-center":!0}},[G],2)})),V={name:"Loader",props:{visible:{type:Boolean,default:!1}}};n("16df");V.render=K,V.__scopeId="data-v-c65888a8";var $=V,Q={class:"navbar navbar-light bg-light"},W={class:"container-fluid"},X={class:"navbar-brand d-flex justify-content-center align-items-center",href:"#"},Z=Object(a["h"])("img",{src:"https://avatars.githubusercontent.com/u/2487851?s=280&v=4",alt:"Logo norsys",width:"100",height:"100",class:"d-inline-block align-top"},null,-1),ee={class:"d-flex flex-column mx-3"},te=Object(a["h"])("h1",null,"Fiche de présence",-1);function ne(e,t,n,r,o,c){return Object(a["t"])(),Object(a["d"])("nav",Q,[Object(a["h"])("div",W,[Object(a["h"])("a",X,[Z,Object(a["h"])("div",ee,[te,Object(a["h"])("h2",null,Object(a["D"])(n.body_title),1)])])])])}var ae={name:"MenuUnlogged",props:{body_title:String}};ae.render=ne;var re=ae,oe={name:"App",components:{Modal:z["a"],Menu:U,MenuUnlogged:re,Loader:$},setup:function(){var e=Object(v["c"])(),t=Object(B["g"])(),n=t.opened,r=t.toggle,o=Object(B["e"])(),c=o.logged,l=Object(B["d"])(),u=l.loader_visible,s=Object(B["c"])(),i=s.api_base,d=s.user,b=d.value.id,p=Object(a["y"])({text:"",type:"",show:!1}),f=Object(a["y"])(null),h=Object(a["y"])(null),j=function(){return document.querySelector("body").style.overflowY="hidden"},O=function(){return document.querySelector("body").style.overflowY="auto"},g=function(){r(),O()},m=function(){f.value.value!==h.value.value?(h.value.classList.add("is-invalid"),p.value={text:"Les 2 mots de passes ne sont pas identiques",type:"danger",show:!0}):fetch("".concat(i,"/user/password"),{method:"post",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:JSON.stringify({method:"put",user_id:b,password:f.value.value})}).then((function(e){return e.json()})).then((function(t){t.error?(h.value.classList.remove("is-valid"),h.value.classList.add("is-invalid"),f.value.classList.remove("is-valid"),f.value.classList.add("is-invalid"),p.value={text:t.message,type:"danger",show:!0}):(h.value.classList.remove("is-invalid"),h.value.classList.add("is-valid"),p.value.show&&(p.value.show=!1),localStorage.removeItem("user"),e.push("/login?passwordUpdated=true"))}))},y=function(e){e.target.previousElementSibling.setAttribute("type","password"===e.target.previousElementSibling.getAttribute("type")?"text":"password")};return{password_modal_opened:n,logged:c,loader_visible:u,alert:p,password:f,password2:h,on_modal_opened:j,on_modal_closed:O,close_password_modal:g,update_password:m,toggle_password_field_type:y}}};oe.render=h;var ce=oe,le=(n("3ca3"),n("ddb0"),{class:"container-fluid mt-2"}),ue={class:"row"},se={class:"col-6 col-md-2 col-lg-1"},ie={class:"col-6 col-md-2 col-lg-1"},de={class:"container"},be={class:"row"},pe={class:"col-12 page-alerts"},fe={class:"table table-responsive"},he=Object(a["h"])("thead",null,[Object(a["h"])("tr",null,[Object(a["h"])("th",null,"Date"),Object(a["h"])("th",null,"Prénom Nom"),Object(a["h"])("th",null,"Heure d'arrivée"),Object(a["h"])("th",null,"Heure de départ")])],-1),ve={key:0},je=Object(a["h"])("tr",null,[Object(a["h"])("td",{colspan:"4",style:{"text-align":"center"}},[Object(a["h"])("strong",null,"Personne à l'agence aujourd'hui")])],-1),Oe={key:1},ge={colspan:"4"},me=Object(a["h"])("i",{class:"fas fa-file-pdf"},null,-1),ye=Object(a["h"])("i",{class:"fas fa-print"},null,-1);function _e(e,t,n,o,c,l){var u=Object(a["B"])("fragment");return Object(a["t"])(),Object(a["d"])(u,null,{default:Object(a["G"])((function(){var n;return[Object(a["h"])("div",le,[Object(a["h"])("div",ue,[Object(a["h"])("div",se,[o.is_arrived(o.presences)?(Object(a["t"])(),Object(a["d"])("button",{key:0,ref:"arrival_btn",class:"btn btn-success btn-disabled",onClick:t[1]||(t[1]=Object(a["H"])((function(){return o.on_arrival&&o.on_arrival.apply(o,arguments)}),["prevent","stop"])),disabled:"disabled"},"Arrivée",512)):(Object(a["t"])(),Object(a["d"])("button",{key:1,ref:"arrival_btn",class:"btn btn-success",onClick:t[2]||(t[2]=Object(a["H"])((function(){return o.on_arrival&&o.on_arrival.apply(o,arguments)}),["prevent","stop"]))},"Arrivée",512))]),Object(a["h"])("div",ie,[o.is_out(o.presences)?(Object(a["t"])(),Object(a["d"])("button",{key:0,ref:"departure_btn",class:"btn btn-success btn-disabled",onClick:t[3]||(t[3]=Object(a["H"])((function(){return o.on_departure&&o.on_departure.apply(o,arguments)}),["prevent","stop"])),disabled:"disabled"},"Départ",512)):(Object(a["t"])(),Object(a["d"])("button",{key:1,ref:"departure_btn",class:"btn btn-success",onClick:t[4]||(t[4]=Object(a["H"])((function(){return o.on_departure&&o.on_departure.apply(o,arguments)}),["prevent","stop"]))},"Départ",512))])])]),Object(a["h"])("div",de,[Object(a["h"])("div",be,[Object(a["h"])("div",pe,[o.alert.show?(Object(a["t"])(),Object(a["d"])("div",{key:0,class:(n={alert:!0},Object(r["a"])(n,"alert-"+o.alert.type,!0),Object(r["a"])(n,"mt-1",!0),n),role:"alert"},Object(a["D"])(o.alert.text),3)):Object(a["e"])("",!0)])])]),Object(a["h"])("table",fe,[he,0===o.presences.length?(Object(a["t"])(),Object(a["d"])("tbody",ve,[je])):(Object(a["t"])(),Object(a["d"])("tbody",Oe,[(Object(a["t"])(!0),Object(a["d"])(a["a"],null,Object(a["z"])(o.presences,(function(e){return Object(a["t"])(),Object(a["d"])("tr",{key:e.id},[Object(a["h"])("td",null,Object(a["D"])(o.date_format(e.arrival_date)),1),Object(a["h"])("td",null,Object(a["D"])(o.full_name(e.firstname,e.lastname)),1),Object(a["h"])("td",null,Object(a["D"])(o.get_arrival(e.arrival_date)),1),Object(a["h"])("td",null,Object(a["D"])(o.get_departure(e.departure_date)),1)])})),128))])),Object(a["h"])("tfoot",null,[Object(a["h"])("tr",null,[Object(a["h"])("td",ge,[Object(a["h"])("button",{type:"button",onClick:t[5]||(t[5]=Object(a["H"])((function(){return o.export_pdf&&o.export_pdf.apply(o,arguments)}),["prevent","stop"])),class:"btn btn-success mx-1"},[me]),Object(a["h"])("button",{type:"button",onClick:t[6]||(t[6]=Object(a["H"])((function(){var t;return e.window.print&&(t=e.window).print.apply(t,arguments)}),["prevent","stop"])),class:"btn btn-success mx-1"},[ye])])])])])]})),_:1})}var we=n("5530"),ke=(n("13d5"),{name:"Home",setup:function(){var e=Object(v["c"])(),t=Object(B["c"])(),n=t.api_base,r=t.user,o=r.id,c=r.email,l=Object(B["f"])(),u=l.presences,s=l.updatePresences,i=Object(B["b"])(),d=i.choosen_date,b=Object(B["d"])(),p=b.show_loader,f=b.hide_loader,h=Object(a["y"])(null),j=Object(a["y"])(null),O=Object(a["y"])({show:!1,text:"",type:"info"}),g=function(e){return e=new Date(e),(e.getDate()<10?"0":"")+e.getDate()+"/"+(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)+"/"+e.getFullYear()},m=function(e,t){return t+" "+e.substr(0,1)+"."},y=function(e){return e=new Date(e),(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())},_=function(e){return null===e?"":(e=new Date(e),(e.getHours()<10?"0"+e.getHours():e.getHours())+":"+(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes()))},w=function(){fetch(n+"/presence",{method:"post",body:JSON.stringify({type:"arrival",user_id:o})}).then((function(e){return e.json()})).then((function(e){e.error||S().then((function(){h.value.classList.add("btn-disabled"),h.value.setAttribute("disabled","disabled"),j.value.classList.remove("btn-disabled"),j.value.removeAttribute("disabled")}))}))},k=function(){fetch(n+"/presence",{method:"post",body:JSON.stringify({type:"departure",user_id:o})}).then((function(e){return e.json()})).then((function(e){e.error||S().then((function(){j.value.classList.add("btn-disabled"),j.value.setAttribute("disabled","disabled")}))}))},D=function(e){return e.reduce((function(e,t){return t.firstname===JSON.parse(localStorage.getItem("user")).firstname&&t.lastname===JSON.parse(localStorage.getItem("user")).lastname&&(e=!0),e}),!1)},x=function(e){return e.reduce((function(e,t){var n=null!==t.departure_date?(parseInt(new Date(t.departure_date).getHours())<10?"0"+new Date(t.departure_date).getHours():new Date(t.departure_date).getHours())+":"+(parseInt(new Date(t.departure_date).getMinutes())<10?"0"+new Date(t.departure_date).getMinutes():new Date(t.departure_date).getMinutes()):"";return t.firstname===JSON.parse(localStorage.getItem("user")).firstname&&t.lastname===JSON.parse(localStorage.getItem("user")).lastname&&n&&(e=!0),e}),!1)},M=function(){var e=d.value;p(),fetch(n+"/export/"+e,{method:"post",body:JSON.stringify({email:c})}).then((function(e){return e.json()})).then((function(e){e.error?O.value={show:!0,text:e.message,type:"danger"}:O.value={show:!0,text:"Un email vous à  été envoyé avec l'export en pièce jointe",type:"success"},f();var t=setTimeout((function(){O.value=Object(we["a"])(Object(we["a"])({},O.value),{},{show:!1}),clearTimeout(t)}),3e3)}))},S=function(){return p(),fetch(n+"/search/history/"+d.value).then((function(e){return e.json()})).then((function(e){return s(e),f(),!0}))};return S(),setInterval(S,3e5),Object(a["o"])((function(){localStorage.getItem("user")||e.push("/login")})),{presences:u,arrival_btn:h,departure_btn:j,alert:O,date_format:g,full_name:m,get_arrival:y,get_departure:_,is_arrived:D,is_out:x,export_pdf:M,on_arrival:w,on_departure:k}}});ke.render=_e;var De=ke,xe=[{path:"/",name:"Home",component:De},{path:"/calendar",name:"Calendar",component:function(){return n.e("chunk-4b0db170").then(n.bind(null,"ac0f"))}},{path:"/recap/list",name:"recapHistorique",component:function(){return n.e("chunk-2d0c4fa8").then(n.bind(null,"3cac"))}},{path:"/recap/:id",name:"recap",component:function(){return n.e("chunk-52d5452e").then(n.bind(null,"a729"))},props:!0},{path:"/recap/edit",name:"recapEdition",component:function(){return n.e("chunk-2b7c4a34").then(n.bind(null,"45ed"))}},{path:"/login",name:"login",component:function(){return n.e("chunk-2d2086b7").then(n.bind(null,"a55b"))}},{path:"/register",name:"register",component:function(){return n.e("chunk-2d0d6d35").then(n.bind(null,"73cf"))}}],Me=Object(v["a"])({history:Object(v["b"])("/"),routes:xe}),Se=Me;Object(a["c"])(ce).use(Se).mount("#app")},"714b":function(e,t,n){"use strict";var a=n("7a23"),r=Object(a["I"])("data-v-b4bcdc36");Object(a["w"])("data-v-b4bcdc36");var o={class:"modal-header"},c={class:"modal-title"},l={class:"modal-body"},u={class:"container"},s={class:"row"},i={class:"col-12"};Object(a["u"])();var d=r((function(e,t,n,r,d,b){return Object(a["t"])(),Object(a["d"])("div",{ref:"modalEl",onClick:t[2]||(t[2]=Object(a["H"])((function(){return r.close&&r.close.apply(r,arguments)}),["prevent","stop"])),class:{"norsys-modal":!0,opened:n.opened}},[Object(a["h"])("div",{class:"modal-content",onClick:Object(a["H"])(!1,["prevent","stop"])},[Object(a["h"])("div",o,[Object(a["h"])("h1",c,Object(a["D"])(n.title),1),Object(a["h"])("a",{href:"#",onClick:t[1]||(t[1]=Object(a["H"])((function(){return r.close&&r.close.apply(r,arguments)}),["prevent","stop"])),class:"btn-close"})]),Object(a["h"])("div",l,[Object(a["h"])("div",u,[Object(a["h"])("div",s,[Object(a["h"])("div",i,[Object(a["h"])("h2",null,Object(a["D"])(n.body_title),1)])]),Object(a["A"])(e.$slots,"default")])])],8,["onClick"])],2)})),b={name:"Modal",props:{title:{type:String},body_title:{type:String,default:""},opened:{type:Boolean,default:!1}},setup:function(e,t){var n=t.emit,r=Object(a["y"])(null);return{modalEl:r,close:function(){return n("close")}}}};n("82ba");b.render=d,b.__scopeId="data-v-b4bcdc36";t["a"]=b},"82ba":function(e,t,n){"use strict";n("c4fd")},"84bd":function(e,t,n){},c4fd:function(e,t,n){},e4da:function(e,t,n){}});
//# sourceMappingURL=app.bd971817.js.map